<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Wasm on Moody&#39;s</title>
    <link>https://mooody.me/tags/wasm/</link>
    <description>Recent content in Wasm on Moody&#39;s</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Sun, 30 May 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://mooody.me/tags/wasm/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>从源码编译 Qt6 for WASM - Part 2</title>
      <link>https://mooody.me/posts/2021-05/qt-build-from-source-2/</link>
      <pubDate>Sun, 30 May 2021 00:00:00 +0000</pubDate>
      
      <guid>https://mooody.me/posts/2021-05/qt-build-from-source-2/</guid>
      <description>&lt;p&gt;&lt;del&gt;时间过得好快，自从上次发 post 已经过了一周&lt;/del&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;趁着深夜停电正好能总结一下这周掉进的坑（我保证没有咕咕咕）&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;1-qt-host-build&#34;&gt;
  1. &amp;ldquo;Qt Host Build&amp;rdquo;?
  &lt;a class=&#34;heading-link&#34; href=&#34;#1-qt-host-build&#34;&gt;
    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;链接到标题&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;链接到标题&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;你看：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;-- Searching for tool &amp;#39;Qt6::moc&amp;#39; in package Qt6CoreTools.
CMake Warning at cmake/QtToolHelpers.cmake:83 (find_package):
  Could not find a configuration file for package &amp;#34;Qt6CoreTools&amp;#34; that is
  compatible with requested version &amp;#34;6.2.0&amp;#34;.

  The following configuration files were considered but not accepted:

    /lib/cmake/Qt6CoreTools/Qt6CoreToolsConfig.cmake, version: 6.1.0

Call Stack (most recent call first):
  src/tools/moc/CMakeLists.txt:8 (qt_internal_add_tool)


CMake Error at cmake/QtToolHelpers.cmake:109 (message):
  The tool &amp;#34;Qt6::moc&amp;#34; was not found in the Qt6CoreTools package.  Package
  found: 0
Call Stack (most recent call first):
  src/tools/moc/CMakeLists.txt:8 (qt_internal_add_tool)


-- Configuring incomplete, errors occurred!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;看到这么一大串错误信息我一下子就慌了，CMake 告诉我 &lt;code&gt;Could not find &amp;quot;Qt6CoreTools&amp;quot; .... with requested version &amp;quot;6.2.0&amp;quot;, The following configuration files were considered but not accepted .... version: 6.1.0&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;好家伙那看来我还需要一个 Qt6 的 Host Build&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;所谓 Host Build 即为本地编译平台环境下的 Qt 编译，或者可以称为 &amp;ldquo;原生平台&amp;rdquo;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这个可怕的事实告诉我： &lt;strong&gt;我还需要编译一个 6.2 的 Linux 版 Qt&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;2-to-build-qt-build-qt-first&#34;&gt;
  2. &lt;del&gt;To Build Qt, Build Qt First&lt;/del&gt;
  &lt;a class=&#34;heading-link&#34; href=&#34;#2-to-build-qt-build-qt-first&#34;&gt;
    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;链接到标题&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;链接到标题&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;既然 Qt 6.1 无法满足编译的要求，那么就得整一个 6.2 版本 Native Platform 的 Qt 当 Host&lt;/p&gt;
&lt;p&gt;首先使用 &lt;strong&gt;传 统 艺 能&lt;/strong&gt;： &lt;code&gt;mkdir build; cd build; cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=host_installed&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;hellip;&amp;hellip;
💥 BOOM 💥
&amp;hellip;&amp;hellip;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;QtGraphicalEffects 和 Qt5Compat 里面的 GraphicalEffects 撞了 Target&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;手动删掉了 qt5/qt5compat 文件夹来避免被 build&lt;/li&gt;
&lt;li&gt;或许正赶上 Qt 在进行 repo 转移，后续尝试的时候就没有出现这个错误了&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;第一次尝试的时候忘记加 ccache，编译一次大概半个小时，用 ccache 能节约至少三分之一&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Qt 的编译参数很人性化，直接一个 &lt;code&gt;-DQT_USE_CCACHE=ON&lt;/code&gt; 就完事了&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;因为在 &lt;a href=&#34;https://github.com/qt/qtbase/blob/9db7cc79a26ced4997277b5c206ca15949133240/cmake/QtSetup.cmake#L217&#34;  class=&#34;external-link&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;这个地方&lt;/a&gt; 会自动查找 ccache&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;根据 QtCreator 的 CI 配置来看，ccache 要加一些 sloppiness 设置（比如 &lt;code&gt;time_macros&lt;/code&gt;, &lt;code&gt;pch_defines&lt;/code&gt; 和 &lt;code&gt;file_macro&lt;/code&gt;）于是照搬了过来&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;3-重新编译-wasm-版本&#34;&gt;
  3. 重新编译 WASM 版本
  &lt;a class=&#34;heading-link&#34; href=&#34;#3-%e9%87%8d%e6%96%b0%e7%bc%96%e8%af%91-wasm-%e7%89%88%e6%9c%ac&#34;&gt;
    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;链接到标题&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;链接到标题&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;经过了千辛万苦，终于成功编译出了 Native Platform Qt，下面就要进行紧张刺激的 Cross-Compile 环节&lt;/p&gt;
&lt;h3 id=&#34;31-错误的编译参数&#34;&gt;
  3.1 错误的编译参数
  &lt;a class=&#34;heading-link&#34; href=&#34;#31-%e9%94%99%e8%af%af%e7%9a%84%e7%bc%96%e8%af%91%e5%8f%82%e6%95%b0&#34;&gt;
    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;链接到标题&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;链接到标题&lt;/span&gt;
  &lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;使用上一篇文章中的 CMake 参数，并修改对应 &lt;code&gt;QT_HOST_PATH&lt;/code&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cmake ~/Work/qt5/qtbase/ &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -GNinja &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DFEATURE_developer_build&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;ON &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DFEATURE_headersclean&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;OFF &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DFEATURE_precompile_header&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;OFF &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DWARNINGS_ARE_ERRORS&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;OFF &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DBUILD_EXAMPLES&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;OFF &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DBUILD_TESTING&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;OFF &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DCMAKE_INSTALL_PREFIX&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;~/Work/qt-build/wasm-installed &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DCMAKE_TOOLCHAIN_FILE&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;~/.local/emsdk/upstream/emscripten/cmake/Modules/Platform/Emscripten.cmake &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DQT_HOST_PATH&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;~/Work/qt-build/host-installed
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;看这节标题就能猜到了，CMake 抱怨 &lt;code&gt;ERROR: Static builds don&#39;t support RPATH&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;喵？ 都 Target WASM 了还不知道自己关掉 RPATH？&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;于是搜索相关参数： &lt;code&gt;-DFEATURE_rpath=OFF&lt;/code&gt;，并清除 CMake 缓存重新编译&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;漫长的一个小时过去了，QtBase 模块终于编译完，心情激动直接当场 &lt;code&gt;cmake --install .&lt;/code&gt; 并开始编译其他模块：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;QtShaderTools&lt;/li&gt;
&lt;li&gt;QtSvg&lt;/li&gt;
&lt;li&gt;QtImageFormats&lt;/li&gt;
&lt;li&gt;QtDeclarative&lt;/li&gt;
&lt;li&gt;QtCharts&lt;/li&gt;
&lt;li&gt;QtRemoteObjects&lt;/li&gt;
&lt;li&gt;QtWebSocket&lt;/li&gt;
&lt;li&gt;QtQuick3D、&lt;/li&gt;
&lt;li&gt;QtQuickTimeLine&lt;/li&gt;
&lt;li&gt;QtDataVisualization&lt;/li&gt;
&lt;li&gt;&amp;hellip;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Qt Company 很人性化的提供了 &lt;code&gt;$QT_INSTALL_DIR/bin/qt-configure-modules&lt;/code&gt; 于是直接带着源代码文件夹当作参数用就完事了&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#8be9fd;font-style:italic&#34;&gt;$QT_INSTALL_DIR&lt;/span&gt;/bin/qt-configure-modules ~/Work/qt5/-MODULE_NAME-
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;就这样编译好了所有需要的 Modules 却在使用上遇到了一些问题&lt;/p&gt;
&lt;p&gt;⬅️ To Be Continued&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>从源码编译 Qt6 for WASM - Part 1</title>
      <link>https://mooody.me/posts/2021-05/qt-build-from-source/</link>
      <pubDate>Mon, 24 May 2021 00:00:00 +0000</pubDate>
      
      <guid>https://mooody.me/posts/2021-05/qt-build-from-source/</guid>
      <description>&lt;h2 id=&#34;1-qt6&#34;&gt;
  1. Qt6
  &lt;a class=&#34;heading-link&#34; href=&#34;#1-qt6&#34;&gt;
    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;链接到标题&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;链接到标题&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;时光荏苒，&lt;a href=&#34;https://www.qt.io/blog/qt-6.0-released&#34;  class=&#34;external-link&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Qt6 发布&lt;/a&gt; 已经是去年的事情，截止到写文章的时候 Qt 6.1 都已经发布很久&lt;/p&gt;
&lt;p&gt;Qt5 和 6 之间一个重大的改变就是 Build System 从 qmake 转向了 CMake （太好了！），而后者有更多的 C/C++ 项目支持。&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;在 GitHub 搜索 qmake&#34; src=&#34;https://mooody.me/posts/2021-05/qt-build-from-source/search-qmake.png&#34;&gt; &lt;img alt=&#34;在 GitHub 搜索 CMake&#34; src=&#34;https://mooody.me/posts/2021-05/qt-build-from-source/search-cmake.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;（这数量级之差不用我多说啥了吧）&lt;/p&gt;
&lt;p&gt;Qt 6.0 主要的目标是 &amp;ldquo;能用就行&amp;rdquo;，因此他们只在 release 里面包含了&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;qtbase&lt;/code&gt;，&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qtdeclarative&lt;/code&gt;，&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qt5compat&lt;/code&gt;，&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qtshadertools&lt;/code&gt;，&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qtwayland&lt;/code&gt; 和 &lt;code&gt;qtquick3d&lt;/code&gt; 这些相对基础的组件。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Qt 6.1 在此基础上又增加了&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;qtcharts&lt;/code&gt;，&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qtdatavis3d&lt;/code&gt;，&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qtimageformats&lt;/code&gt;，&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qtnetworkauth&lt;/code&gt;，&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qtvirtualkeyboard&lt;/code&gt; 和 &lt;code&gt;qtlottie&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;相比之下 6.1 包含的组件已经很多了&lt;/p&gt;
&lt;h2 id=&#34;2-wasm&#34;&gt;
  2. WASM
  &lt;a class=&#34;heading-link&#34; href=&#34;#2-wasm&#34;&gt;
    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;链接到标题&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;链接到标题&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;我心心念念的 Qt for WASM 还是没来。&lt;/p&gt;
&lt;p&gt;后来看到 &lt;em&gt;&lt;a href=&#34;https://bugreports.qt.io/browse/QTBUG-87471&#34;  class=&#34;external-link&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;QTBUG-87471&lt;/a&gt;&lt;/em&gt; 才知道还得等到 Qt 6.2，这让我萌生了从源码编译的&lt;del&gt;冲动&lt;/del&gt;&lt;/p&gt;
&lt;h2 id=&#34;3-能编译了吗&#34;&gt;
  3. “能编译了吗？”
  &lt;a class=&#34;heading-link&#34; href=&#34;#3-%e8%83%bd%e7%bc%96%e8%af%91%e4%ba%86%e5%90%97&#34;&gt;
    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;链接到标题&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;链接到标题&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;因为要编译的是 dev 分支的 Qt6，我决定用 git 拉源码，还能随时 &lt;code&gt;git pull&lt;/code&gt; 到最新的版本，于是开始 clone&lt;/p&gt;
&lt;p&gt;试了一圈发现 GitHub 的 &lt;a href=&#34;https://github.com/qt/qt5&#34;  class=&#34;external-link&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;mirror&lt;/a&gt; 比较快 &lt;del&gt;(虽然 repo 叫 qt5 但他其实里面是 qt 的 dev 分支，简直太迷惑了)&lt;/del&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;$ git clone https://github.com/qt/qt5 --recursive &lt;span style=&#34;color:#6272a4&#34;&gt;# 使用 recursive 把所有 submodules 都拉下来！&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;「&lt;em&gt;哦淦，dev 分支没有文档啊&lt;/em&gt;」&lt;/p&gt;
&lt;p&gt;…… （冷场）&lt;/p&gt;
&lt;h2 id=&#34;4-藏在角落的编译文档&#34;&gt;
  4. 藏在角落的编译文档
  &lt;a class=&#34;heading-link&#34; href=&#34;#4-%e8%97%8f%e5%9c%a8%e8%a7%92%e8%90%bd%e7%9a%84%e7%bc%96%e8%af%91%e6%96%87%e6%a1%a3&#34;&gt;
    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;链接到标题&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;链接到标题&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;经过了 114514 小时的高强度搜索，终于在 &lt;a href=&#34;https://bugreports.qt.io/browse/QTBUG-78647#comment-539018&#34;  class=&#34;external-link&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;QTBUG-78647&lt;/a&gt; 评论区找到了一点点编译参数的 Hints&lt;/p&gt;
&lt;p&gt;于是立即开始 build, 看了看两个 notes 都跟我没关系嘛&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&amp;ldquo;&lt;em&gt;NOTE You need an ultra recent version of cmake&lt;/em&gt;&amp;rdquo;
&lt;ul&gt;
&lt;li&gt;Arch 用户从来不担心版本太旧&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&amp;ldquo;&lt;em&gt;NOTE You will need to host build of Qt 6.0.x, easiest to download the binary release for your desktop platform. Building from git also works.&lt;/em&gt;&amp;rdquo;
&lt;ul&gt;
&lt;li&gt;喵？ 那我 &lt;code&gt;pacman -S qt6&lt;/code&gt; 不就好了&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;5-开搞&#34;&gt;
  5. 开搞！
  &lt;a class=&#34;heading-link&#34; href=&#34;#5-%e5%bc%80%e6%90%9e&#34;&gt;
    &lt;i class=&#34;fa-solid fa-link&#34; aria-hidden=&#34;true&#34; title=&#34;链接到标题&#34;&gt;&lt;/i&gt;
    &lt;span class=&#34;sr-only&#34;&gt;链接到标题&lt;/span&gt;
  &lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;拿来评论区的编译参数，稍微改了改，就变成了&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 1
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 2
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 3
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 4
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 5
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 6
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 7
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 8
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt; 9
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;10
&lt;/span&gt;&lt;span style=&#34;white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;cmake ~/Work/qt5/qtbase/ &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -GNinja &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DFEATURE_developer_build&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;ON &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DFEATURE_headersclean&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;OFF &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DFEATURE_precompile_header&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;OFF &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DWARNINGS_ARE_ERRORS&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;OFF &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DBUILD_EXAMPLES&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;OFF &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DBUILD_TESTING&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;OFF &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DCMAKE_INSTALL_PREFIX&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;~/Work/qt-build/wasm-installed &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DCMAKE_TOOLCHAIN_FILE&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;~/.local/emsdk/upstream/emscripten/cmake/Modules/Platform/Emscripten.cmake &lt;span style=&#34;color:#f1fa8c&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#f1fa8c&#34;&gt;&lt;/span&gt;  -DQT_HOST_PATH&lt;span style=&#34;color:#ff79c6&#34;&gt;=&lt;/span&gt;/
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Qt 的 CMake Configure 过程异常地耗时，于是漫长的等待开始了&lt;/p&gt;
&lt;p&gt;⬅️ To Be Continued&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>